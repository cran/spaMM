print("test corrHLfit:")

# corrHLfit
## this test is implied by test-fixedLRT.R hence is not useful

data(blackcap)
fullfit <- corrHLfit(migStatus ~ means+ Matern(1|latitude+longitude),data=blackcap,
                     HLmethod="ML") ## takes ~ 6s
summary(fullfit)
nullfit <- corrHLfit(migStatus ~ 1 + Matern(1|latitude+longitude),data=blackcap,
                     HLmethod="ML") ## takes ~ 3s
summary(nullfit)
## p-value:
pv <- 1-pchisq(2*(fullfit$APHLs$p_v-nullfit$APHLs$p_v),df=1)

expect_equal(pv,0.008070489,tolerance=1e-5)

nullfit <- corrHLfit(migStatus ~ 1 + Matern(1|latitude+longitude),data=blackcap,
                     HLmethod="ML",control.dist=list(dist.method="Geodesic")) ## takes ~ 3s
p1 <- predict(nullfit)[1]
expect_equal(p1,0.9311825,tolerance=1e-5) ## this tests an incorrect value. Wea re in a.txt file... 
p2 <- predict(nullfit,newdata=blackcap)[1]
expect_equal(p2,0.9311825,tolerance=1e-5)
